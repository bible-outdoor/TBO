<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin Dashboard | The Bible Outdoor</title>
  <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no">  
  <link rel="icon" type="image/x-icon" href="../assets/favicon.ico" />
  <link rel="stylesheet" href="admin.css">
  <!-- Cropper.js CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.6.2/cropper.min.css"> 
</head>
<body>
  <div id="loaderOverlay" class="loader-overlay" style="display:none;"><div class="spinner"></div></div>
  <!-- Notification Container -->
  <!-- Confirmation Modal Template -->
  <template id="confirmModalTemplate">
    <div class="form-overlay">
      <div class="form-modal" role="dialog" aria-labelledby="confirmTitle">
        <button class="close-btn" aria-label="Close">&times;</button>
        <h3 id="confirmTitle">Confirm Action</h3>
        <p>Are you sure you want to delete this user? This action cannot be undone.</p>
        <div style="display: flex; justify-content: flex-end; gap: 1em; margin-top: 1em;">
          <button type="button" class="btn" onclick="closeConfirmModal()">Cancel</button>
          <button type="button" class="btn" style="background: #e53935;" onclick="confirmDeleteUser()">Delete</button>
        </div>
      </div>
    </div>
  </template>  <!-- Only one toggle button -->
  
  <button class="admin-sidebar-toggle" aria-label="Open Sidebar">&#9776;</button>
  <div id="adminApp" class="admin-app">
    <aside class="admin-sidebar" id="adminSidebar">
      
      <div class="sidebar-brand">
        <button class="mode-toggle" id="modeToggle" title="Toggle dark/light mode"></button>
        <span>ðŸ‘¤ Admin</span>
      </div>
      <nav>
        <ul>
          <li><a href="#overview" class="nav-link active">Dashboard</a></li>
          <li><a href="#sermons" class="nav-link">Sermon Manager</a></li>
          <li><a href="#sunday" class="nav-link">Sunday Service</a></li>
          <li><a href="#training" class="nav-link">Library</a></li>
          <li><a href="#media" class="nav-link">Media Archive</a></li>
          <li><a href="#events" class="nav-link">Event Manager</a></li>
          <li><a href="#contacts" class="nav-link">Contacts</a></li>
          <!-- Testimonies link will be injected by admin.js for superadmin/supereditor only -->
          <li><a href="#donation" class="nav-link">Donation Settings</a></li>
          <li><a href="#products" class="nav-link">Product Manager</a></li>
          <li><a href="#users" class="nav-link">User Manager</a></li>
          <li><a href="#settings" class="nav-link">Site Settings</a></li>

        </ul>
      </nav>
      <button class="sidebar-toggle" id="sidebarToggle">â˜°</button>
      <div class="admin-user-info" id="adminUserInfo">
        <span id="adminNameLabel"></span>
        <span id="adminRoleLabel"></span>
      </div>
      
      
      <button class="logout-btn" onclick="logoutAdmin()">Logout</button>
    </aside>
    <!-- Mobile fixed logout button -->
    <button class="logout-btn logout-btn-mobile" onclick="logoutAdmin()">Logout</button>
    <!-- ...existing code... -->
    <!-- Only one backdrop, right after the sidebar -->
    <div class="admin-sidebar-backdrop"></div>
    <main class="admin-main" id="adminMain">
      <!-- Section content will render here -->
    </main>
  </div>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const sidebar = document.querySelector('.admin-sidebar');
      const toggleBtn = document.querySelector('.admin-sidebar-toggle');
      const backdrop = document.querySelector('.admin-sidebar-backdrop');
      const navLinks = sidebar.querySelectorAll('nav a');

      function openSidebar() {
        sidebar.classList.add('drawer-open');
        backdrop.style.display = 'block';
        document.body.style.overflow = 'hidden';
      }
      function closeSidebar() {
        sidebar.classList.remove('drawer-open');
        backdrop.style.display = 'none';
        document.body.style.overflow = '';
      }
      function toggleSidebar() {
        if (sidebar.classList.contains('drawer-open')) {
          closeSidebar();
        } else {
          openSidebar();
        }
      }
      if(toggleBtn && sidebar && backdrop){
        toggleBtn.addEventListener('click', toggleSidebar);
        backdrop.addEventListener('click', closeSidebar);
        document.addEventListener('keydown', function(e){
          if(e.key === "Escape") closeSidebar();
        });
        // Close sidebar on link click (mobile only)
        navLinks.forEach(link => {
          link.addEventListener('click', function() {
            if (window.innerWidth <= 900) closeSidebar();
          });
        });
      }
    });
  </script>
  <script src="admin.js"></script>
  <script>if (typeof requireAdminAuth === 'function') requireAdminAuth();</script>
  <!-- Cropper.js JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.6.2/cropper.min.js"></script> 
</body>
</html>